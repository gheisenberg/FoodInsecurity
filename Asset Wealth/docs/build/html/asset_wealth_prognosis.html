
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Predict Asset Wealth for Testset and Mozambique &#8212; Asset Wealth Prognosis 06/01/2022 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Split and copy raw GeoTIFFs to separate directories for preprocessing" href="split_geotiffs_for_preprocessing.html" />
    <link rel="prev" title="Statistical Analysis of Asset Wealth" href="asset_wealth_analysis.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Asset Wealth Prognosis 06/01/2022 documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  See Documentation of Scripts and Notebooks:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="src.html">
   Python Scripts
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="notebooks.html">
   Notebooks
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="asset_wealth_analysis.html">
     Statistical Analysis of Asset Wealth
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Predict Asset Wealth for Testset and Mozambique
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="split_geotiffs_for_preprocessing.html">
     Split and copy raw GeoTIFFs to separate directories for preprocessing
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/asset_wealth_prognosis.ipynb.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Predict-Asset-Wealth-for-Testset">
   Predict Asset Wealth for Testset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Import-Data">
   Import Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Satellite-Images">
     Satellite Images
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Geographic-Information">
     Geographic Information
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Urban-Data">
     Urban Data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Get-Predictions-of-Best-Model">
       Get Predictions of Best Model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Create-Geo-DataFrames-for-Groundtruth-and-Predictions">
       Create Geo DataFrames for Groundtruth and Predictions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Plot-Predictions-vs. Groundtruth">
       Plot Predictions vs. Groundtruth
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Rural-Data">
     Rural Data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Get-Label-Data">
       Get Label Data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Get Predictions of Best Model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Create Geo DataFrames for Groundtruth and Predictions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Plot Predictions vs. Groundtruth
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Combine-rural-and-urban-predictions-and-labels">
   Combine rural and urban predictions and labels
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Plot-all-predictions">
     Plot all predictions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Get-r2-Score-for-best-Models">
     Get r2 Score for best Models
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Save-Predictions-and-Groundtruth">
     Save Predictions and Groundtruth
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Predict-Asset-Wealth-for-Mozambique">
   Predict Asset Wealth for Mozambique
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Load-general-geographic-Data-of-Mozambique">
     Load general geographic Data of Mozambique
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Load-Mozambique-Survey-Data">
   Load Mozambique Survey Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Urban">
   Urban
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Load-Data-for-Mozambique-2016,-2017,-2019,-2020-and-2021">
     Load Data for Mozambique 2016, 2017, 2019, 2020 and 2021
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Predict-Asset-Wealth">
     Predict Asset Wealth
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Merge-Predictions-with-Survey-Data">
     Merge Predictions with Survey Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Merge Predictions with Survey Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Rural">
   Rural
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Load Data for Mozambique 2016, 2017, 2019, 2020 and 2021
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     Predict Asset Wealth
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     Merge Predictions with Survey Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Get-Geocoordinates-and-create-Geometry-Objects">
     Get Geocoordinates and create Geometry Objects
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     Merge Predictions with Survey Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Plot-Predictions">
   Plot Predictions
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Predict Asset Wealth for Testset and Mozambique</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Predict-Asset-Wealth-for-Testset">
   Predict Asset Wealth for Testset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Import-Data">
   Import Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Satellite-Images">
     Satellite Images
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Geographic-Information">
     Geographic Information
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Urban-Data">
     Urban Data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Get-Predictions-of-Best-Model">
       Get Predictions of Best Model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Create-Geo-DataFrames-for-Groundtruth-and-Predictions">
       Create Geo DataFrames for Groundtruth and Predictions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Plot-Predictions-vs. Groundtruth">
       Plot Predictions vs. Groundtruth
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Rural-Data">
     Rural Data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#Get-Label-Data">
       Get Label Data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Get Predictions of Best Model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Create Geo DataFrames for Groundtruth and Predictions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Plot Predictions vs. Groundtruth
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Combine-rural-and-urban-predictions-and-labels">
   Combine rural and urban predictions and labels
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Plot-all-predictions">
     Plot all predictions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Get-r2-Score-for-best-Models">
     Get r2 Score for best Models
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Save-Predictions-and-Groundtruth">
     Save Predictions and Groundtruth
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Predict-Asset-Wealth-for-Mozambique">
   Predict Asset Wealth for Mozambique
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Load-general-geographic-Data-of-Mozambique">
     Load general geographic Data of Mozambique
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Load-Mozambique-Survey-Data">
   Load Mozambique Survey Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Urban">
   Urban
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Load-Data-for-Mozambique-2016,-2017,-2019,-2020-and-2021">
     Load Data for Mozambique 2016, 2017, 2019, 2020 and 2021
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Predict-Asset-Wealth">
     Predict Asset Wealth
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Merge-Predictions-with-Survey-Data">
     Merge Predictions with Survey Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Merge Predictions with Survey Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Rural">
   Rural
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Load Data for Mozambique 2016, 2017, 2019, 2020 and 2021
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     Predict Asset Wealth
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     Merge Predictions with Survey Data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Get-Geocoordinates-and-create-Geometry-Objects">
     Get Geocoordinates and create Geometry Objects
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     Merge Predictions with Survey Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Plot-Predictions">
   Plot Predictions
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Predict-Asset-Wealth-for-Testset-and-Mozambique">
<h1>Predict Asset Wealth for Testset and Mozambique<a class="headerlink" href="#Predict-Asset-Wealth-for-Testset-and-Mozambique" title="Permalink to this headline">#</a></h1>
<section id="Predict-Asset-Wealth-for-Testset">
<h2>Predict Asset Wealth for Testset<a class="headerlink" href="#Predict-Asset-Wealth-for-Testset" title="Permalink to this headline">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;TF_CPP_MIN_LOG_LEVEL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;3&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_DEVICE_ORDER&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;PCI_BUS_ID&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;2&quot;</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">optimizers</span><span class="p">,</span> <span class="n">models</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">from</span> <span class="nn">pyproj</span> <span class="kn">import</span> <span class="n">CRS</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">rasterio</span>

<span class="kn">from</span> <span class="nn">src.data_utils</span> <span class="kn">import</span> <span class="n">combine_wealth_dfs</span>
<span class="kn">from</span> <span class="nn">src.data_utils</span> <span class="kn">import</span> <span class="n">get_label_for_img</span>
<span class="kn">from</span> <span class="nn">src.data_utils</span> <span class="kn">import</span> <span class="n">create_splits</span>

<span class="n">crs</span> <span class="o">=</span> <span class="n">CRS</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Import-Data">
<h2>Import Data<a class="headerlink" href="#Import-Data" title="Permalink to this headline">#</a></h2>
<section id="Satellite-Images">
<h3>Satellite Images<a class="headerlink" href="#Satellite-Images" title="Permalink to this headline">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">viirs_s2_path</span> <span class="o">=</span> <span class="s1">&#39;/mnt/datadisk/data/VIIRS_Sentinel2/asset/urban/all/&#39;</span>
<span class="n">viirs_path</span> <span class="o">=</span> <span class="s1">&#39;/mnt/datadisk/data/VIIRS/preprocessed/asset/rural//all/&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_urban_data</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">viirs_s2_path</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">all_urban_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2458
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_rural_data</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">viirs_path</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">all_rural_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
5602
</pre></div></div>
</div>
</section>
<section id="Geographic-Information">
<h3>Geographic Information<a class="headerlink" href="#Geographic-Information" title="Permalink to this headline">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">countries</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_urban_data</span><span class="p">]))</span>
<span class="n">countries</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;UGA&#39;, &#39;COD&#39;, &#39;MOZ&#39;, &#39;MWI&#39;, &#39;ETH&#39;, &#39;ZMB&#39;, &#39;KEN&#39;, &#39;TZA&#39;, &#39;RWA&#39;, &#39;ZWE&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">gpd</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="s1">&#39;naturalearth_lowres&#39;</span><span class="p">))</span>
<span class="n">countries_gdf</span> <span class="o">=</span> <span class="n">world</span><span class="p">[</span><span class="n">world</span><span class="o">.</span><span class="n">iso_a3</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">countries</span><span class="p">)]</span>
<span class="n">countries_gdf</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pop_est</th>
      <th>continent</th>
      <th>name</th>
      <th>iso_a3</th>
      <th>gdp_md_est</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>53950935</td>
      <td>Africa</td>
      <td>Tanzania</td>
      <td>TZA</td>
      <td>150600.0</td>
      <td>POLYGON ((33.90371 -0.95000, 34.07262 -1.05982...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>83301151</td>
      <td>Africa</td>
      <td>Dem. Rep. Congo</td>
      <td>COD</td>
      <td>66010.0</td>
      <td>POLYGON ((29.34000 -4.49998, 29.51999 -5.41998...</td>
    </tr>
    <tr>
      <th>13</th>
      <td>47615739</td>
      <td>Africa</td>
      <td>Kenya</td>
      <td>KEN</td>
      <td>152700.0</td>
      <td>POLYGON ((39.20222 -4.67677, 37.76690 -3.67712...</td>
    </tr>
    <tr>
      <th>48</th>
      <td>13805084</td>
      <td>Africa</td>
      <td>Zimbabwe</td>
      <td>ZWE</td>
      <td>28330.0</td>
      <td>POLYGON ((31.19141 -22.25151, 30.65987 -22.151...</td>
    </tr>
    <tr>
      <th>70</th>
      <td>15972000</td>
      <td>Africa</td>
      <td>Zambia</td>
      <td>ZMB</td>
      <td>65170.0</td>
      <td>POLYGON ((30.74001 -8.34001, 31.15775 -8.59458...</td>
    </tr>
    <tr>
      <th>71</th>
      <td>19196246</td>
      <td>Africa</td>
      <td>Malawi</td>
      <td>MWI</td>
      <td>21200.0</td>
      <td>POLYGON ((32.75938 -9.23060, 33.73972 -9.41715...</td>
    </tr>
    <tr>
      <th>72</th>
      <td>26573706</td>
      <td>Africa</td>
      <td>Mozambique</td>
      <td>MOZ</td>
      <td>35010.0</td>
      <td>POLYGON ((34.55999 -11.52002, 35.31240 -11.439...</td>
    </tr>
    <tr>
      <th>165</th>
      <td>105350020</td>
      <td>Africa</td>
      <td>Ethiopia</td>
      <td>ETH</td>
      <td>174700.0</td>
      <td>POLYGON ((47.78942 8.00300, 44.96360 5.00162, ...</td>
    </tr>
    <tr>
      <th>168</th>
      <td>39570125</td>
      <td>Africa</td>
      <td>Uganda</td>
      <td>UGA</td>
      <td>84930.0</td>
      <td>POLYGON ((33.90371 -0.95000, 31.86617 -1.02736...</td>
    </tr>
    <tr>
      <th>169</th>
      <td>11901484</td>
      <td>Africa</td>
      <td>Rwanda</td>
      <td>RWA</td>
      <td>21970.0</td>
      <td>POLYGON ((30.41910 -1.13466, 30.81613 -1.69891...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Urban-Data">
<h3>Urban Data<a class="headerlink" href="#Urban-Data" title="Permalink to this headline">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_val</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train_val</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">create_splits</span><span class="p">(</span><span class="n">img_dir</span><span class="o">=</span><span class="s1">&#39;/mnt/datadisk/data/VIIRS_Sentinel2/asset/urban/all/&#39;</span><span class="p">,</span> <span class="n">wealth_path</span><span class="o">=</span><span class="s1">&#39;/home/stoermer/Sentinel/gps_csv/&#39;</span><span class="p">,</span> <span class="n">urban_rural</span><span class="o">=</span><span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="n">pre2015_path</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Gathering Label Data
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|███████████████████████████████████████████████████████████████████████████████| 2458/2458 [01:03&lt;00:00, 38.76it/s]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wealth_df</span> <span class="o">=</span> <span class="n">combine_wealth_dfs</span><span class="p">(</span><span class="s1">&#39;/home/stoermer/Sentinel/gps_csv/&#39;</span><span class="p">)</span>

<span class="n">urban_test_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">X_test</span><span class="p">):</span>
    <span class="n">urban_test_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">urban_test_labels</span><span class="p">,</span> <span class="n">get_label_for_img</span><span class="p">(</span><span class="n">wealth_df</span><span class="p">,</span> <span class="n">x</span><span class="p">)])</span>
<span class="n">urban_test_labels</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "86f283d9810c4d80815ba215dc66ddb9", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>WEALTH_INDEX</th>
      <th>SURVEY_YEAR</th>
      <th>LATNUM</th>
      <th>LONGNUM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.071443</td>
      <td>2015</td>
      <td>-17.9025</td>
      <td>30.6523</td>
    </tr>
    <tr>
      <th>0</th>
      <td>-0.068987</td>
      <td>2014</td>
      <td>-9.8081</td>
      <td>29.0395</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2.655006</td>
      <td>2013</td>
      <td>-4.3835</td>
      <td>15.3125</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1.668783</td>
      <td>2019</td>
      <td>2.7515</td>
      <td>32.2981</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1.278176</td>
      <td>2015</td>
      <td>-20.1791</td>
      <td>28.6178</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.780936</td>
      <td>2016</td>
      <td>13.3427</td>
      <td>39.7597</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.980313</td>
      <td>2016</td>
      <td>-5.7441</td>
      <td>34.8325</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.135483</td>
      <td>2019</td>
      <td>-2.7007</td>
      <td>29.0006</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2.779817</td>
      <td>2018</td>
      <td>-25.8828</td>
      <td>32.5081</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.327767</td>
      <td>2016</td>
      <td>7.2420</td>
      <td>37.8950</td>
    </tr>
  </tbody>
</table>
<p>492 rows × 4 columns</p>
</div></div>
</div>
<section id="Get-Predictions-of-Best-Model">
<h4>Get Predictions of Best Model<a class="headerlink" href="#Get-Predictions-of-Best-Model" title="Permalink to this headline">#</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;./vgg19_viirs_s2_u.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_urban</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">X_test</span><span class="p">)):</span>
    <span class="c1"># Read in each Image</span>
    <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">viirs_s2_path</span><span class="p">,</span> <span class="n">img</span><span class="p">))</span> <span class="k">as</span> <span class="n">i</span><span class="p">:</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>

    <span class="c1"># Ensure that the Array is not empty</span>
    <span class="n">array</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">array</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">array</span><span class="p">)),</span> <span class="s2">&quot;Float&quot;</span>

    <span class="c1"># Add to batch</span>
    <span class="n">data_urban</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span>

    <span class="c1"># Check if batch is already full (Note: Index in batch array is from 0...4 hence we need to add +1 to batch_ele)</span>
<span class="n">data_urban</span> <span class="o">=</span> <span class="n">data_urban</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">preds_urban</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_urban</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">preds_urban</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "da13a01f8a5b48fca324398e494a7139", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
492
</pre></div></div>
</div>
</section>
<section id="Create-Geo-DataFrames-for-Groundtruth-and-Predictions">
<h4>Create Geo DataFrames for Groundtruth and Predictions<a class="headerlink" href="#Create-Geo-DataFrames-for-Groundtruth-and-Predictions" title="Permalink to this headline">#</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geometry</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">points_from_xy</span><span class="p">(</span><span class="n">urban_test_labels</span><span class="o">.</span><span class="n">LONGNUM</span><span class="p">,</span> <span class="n">urban_test_labels</span><span class="o">.</span><span class="n">LATNUM</span><span class="p">)</span>

<span class="n">true_urban_wealth_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">urban_test_labels</span><span class="p">,</span>
                       <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span>
                       <span class="n">crs</span><span class="o">=</span><span class="n">crs</span>
                      <span class="p">)</span>
<span class="n">true_urban_wealth_df</span><span class="p">[</span><span class="s1">&#39;COUNTRY_CODE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X_test</span><span class="p">]</span>
<span class="n">true_urban_wealth_df</span> <span class="o">=</span> <span class="n">true_urban_wealth_df</span><span class="p">[[</span><span class="s1">&#39;SURVEY_YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">,</span><span class="s1">&#39;COUNTRY_CODE&#39;</span><span class="p">,</span><span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">]]</span>
<span class="n">true_urban_wealth_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SURVEY_YEAR</th>
      <th>geometry</th>
      <th>COUNTRY_CODE</th>
      <th>WEALTH_INDEX</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015</td>
      <td>POINT (30.65230 -17.90250)</td>
      <td>ZWE</td>
      <td>1.071443</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2014</td>
      <td>POINT (29.03950 -9.80810)</td>
      <td>ZMB</td>
      <td>-0.068987</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2013</td>
      <td>POINT (15.31250 -4.38350)</td>
      <td>COD</td>
      <td>2.655006</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_urban_wealth_df</span> <span class="o">=</span> <span class="n">true_urban_wealth_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;SURVEY_YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">]]</span>
<span class="n">predicted_urban_wealth_df</span><span class="p">[</span><span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">preds_urban</span>
<span class="n">predicted_urban_wealth_df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SURVEY_YEAR</th>
      <th>geometry</th>
      <th>WEALTH_INDEX</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015</td>
      <td>POINT (30.65230 -17.90250)</td>
      <td>1.538016</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2014</td>
      <td>POINT (29.03950 -9.80810)</td>
      <td>0.407157</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2013</td>
      <td>POINT (15.31250 -4.38350)</td>
      <td>2.204992</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2019</td>
      <td>POINT (32.29810 2.75150)</td>
      <td>1.057997</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2015</td>
      <td>POINT (28.61780 -20.17910)</td>
      <td>0.996908</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2016</td>
      <td>POINT (39.75970 13.34270)</td>
      <td>0.425004</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2016</td>
      <td>POINT (34.83250 -5.74410)</td>
      <td>1.155177</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2019</td>
      <td>POINT (29.00060 -2.70070)</td>
      <td>0.764184</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2018</td>
      <td>POINT (32.50810 -25.88280)</td>
      <td>1.686300</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2016</td>
      <td>POINT (37.89500 7.24200)</td>
      <td>0.759801</td>
    </tr>
  </tbody>
</table>
<p>492 rows × 3 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crs</span> <span class="o">=</span> <span class="n">CRS</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
<span class="n">predicted_urban_wealth_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">predicted_urban_wealth_df</span><span class="p">,</span>
                                             <span class="n">geometry</span><span class="o">=</span><span class="n">predicted_urban_wealth_df</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">],</span>
                                             <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
<span class="n">true_urban_wealth_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">true_urban_wealth_df</span><span class="p">,</span>
                                             <span class="n">geometry</span><span class="o">=</span><span class="n">true_urban_wealth_df</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">],</span>
                                             <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Plot-Predictions-vs. Groundtruth">
<h4>Plot Predictions vs. Groundtruth<a class="headerlink" href="#Plot-Predictions-vs. Groundtruth" title="Permalink to this headline">#</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">divnorm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">TwoSlopeNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">vcenter</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">4.5</span><span class="p">)</span>
<span class="c1"># plt.subplots_adjust(wspace=None, hspace=None)</span>
<span class="n">markersize</span><span class="o">=</span><span class="mi">7</span>
<span class="n">predicted_countries_gdf</span> <span class="o">=</span> <span class="n">countries_gdf</span><span class="p">[</span><span class="n">countries_gdf</span><span class="o">.</span><span class="n">iso_a3</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">true_urban_wealth_df</span><span class="o">.</span><span class="n">COUNTRY_CODE</span><span class="p">)]</span>

<span class="n">mosaic</span> <span class="o">=</span>  <span class="p">[[</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2015&#39;</span><span class="p">,</span><span class="s1">&#39;title_2015&#39;</span><span class="p">,</span><span class="s1">&#39;title_2015&#39;</span><span class="p">,</span><span class="s1">&#39;title_2015&#39;</span><span class="p">,</span><span class="s1">&#39;title_2015&#39;</span><span class="p">,</span><span class="s1">&#39;title_2015&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;true2012&#39;</span><span class="p">,</span><span class="s1">&#39;true2012&#39;</span><span class="p">,</span><span class="s1">&#39;true2012&#39;</span><span class="p">,</span><span class="s1">&#39;pred2012&#39;</span><span class="p">,</span><span class="s1">&#39;pred2012&#39;</span><span class="p">,</span><span class="s1">&#39;pred2012&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;true2013&#39;</span><span class="p">,</span> <span class="s1">&#39;true2013&#39;</span><span class="p">,</span><span class="s1">&#39;true2013&#39;</span><span class="p">,</span><span class="s1">&#39;pred2013&#39;</span><span class="p">,</span><span class="s1">&#39;pred2013&#39;</span><span class="p">,</span><span class="s1">&#39;pred2013&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;true2014&#39;</span><span class="p">,</span><span class="s1">&#39;true2014&#39;</span><span class="p">,</span><span class="s1">&#39;true2014&#39;</span><span class="p">,</span><span class="s1">&#39;pred2014&#39;</span><span class="p">,</span><span class="s1">&#39;pred2014&#39;</span><span class="p">,</span><span class="s1">&#39;pred2014&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
        <span class="s1">&#39;true2015&#39;</span><span class="p">,</span><span class="s1">&#39;true2015&#39;</span><span class="p">,</span><span class="s1">&#39;true2015&#39;</span><span class="p">,</span><span class="s1">&#39;pred2015&#39;</span><span class="p">,</span><span class="s1">&#39;pred2015&#39;</span><span class="p">,</span><span class="s1">&#39;pred2015&#39;</span><span class="p">],</span>
           <span class="p">[</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2020&#39;</span><span class="p">,</span><span class="s1">&#39;title_2020&#39;</span><span class="p">,</span><span class="s1">&#39;title_2020&#39;</span><span class="p">,</span><span class="s1">&#39;title_2020&#39;</span><span class="p">,</span><span class="s1">&#39;title_2020&#39;</span><span class="p">,</span><span class="s1">&#39;title_2020&#39;</span><span class="p">],</span>
           <span class="p">[</span><span class="s1">&#39;true2016&#39;</span><span class="p">,</span><span class="s1">&#39;true2016&#39;</span><span class="p">,</span><span class="s1">&#39;true2016&#39;</span><span class="p">,</span><span class="s1">&#39;pred2016&#39;</span><span class="p">,</span><span class="s1">&#39;pred2016&#39;</span><span class="p">,</span><span class="s1">&#39;pred2016&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;true2018&#39;</span><span class="p">,</span><span class="s1">&#39;true2018&#39;</span><span class="p">,</span><span class="s1">&#39;true2018&#39;</span><span class="p">,</span> <span class="s1">&#39;pred2018&#39;</span><span class="p">,</span> <span class="s1">&#39;pred2018&#39;</span><span class="p">,</span><span class="s1">&#39;pred2018&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;true2019&#39;</span><span class="p">,</span><span class="s1">&#39;true2019&#39;</span><span class="p">,</span><span class="s1">&#39;true2019&#39;</span><span class="p">,</span><span class="s1">&#39;pred2019&#39;</span><span class="p">,</span><span class="s1">&#39;pred2019&#39;</span><span class="p">,</span><span class="s1">&#39;pred2019&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;true2020&#39;</span><span class="p">,</span> <span class="s1">&#39;true2020&#39;</span><span class="p">,</span> <span class="s1">&#39;true2020&#39;</span><span class="p">,</span><span class="s1">&#39;pred2020&#39;</span><span class="p">,</span><span class="s1">&#39;pred2020&#39;</span><span class="p">,</span><span class="s1">&#39;pred2020&#39;</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">(</span><span class="n">mosaic</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">height_ratios</span><span class="o">=</span><span class="p">(</span><span class="mf">.8</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mi">3</span><span class="p">))))</span><span class="c1">#, constrained_layout=True)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Vergleich der Vorhersagen und wahren Labels für das urbane Testset&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mosaic</span><span class="p">):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">row</span> <span class="k">if</span> <span class="n">k</span><span class="o">!=</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
    <span class="n">keys</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="c1">#     print(keys)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
        <span class="n">predicted_countries_gdf</span> <span class="o">=</span> <span class="n">countries_gdf</span><span class="p">[</span><span class="n">countries_gdf</span><span class="o">.</span><span class="n">iso_a3</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">true_urban_wealth_df</span><span class="p">[</span><span class="n">true_urban_wealth_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])]</span><span class="o">.</span><span class="n">COUNTRY_CODE</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">y</span><span class="o">=-</span><span class="mf">5.5</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;true&#39;</span><span class="p">):</span>
            <span class="n">predicted_countries_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
            <span class="n">true_urban_wealth_df</span><span class="p">[</span><span class="n">true_urban_wealth_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">predicted_countries_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
            <span class="n">predicted_urban_wealth_df</span><span class="p">[</span><span class="n">predicted_urban_wealth_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>

<span class="n">line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">.925</span><span class="p">],[</span><span class="mf">.45</span><span class="p">,</span><span class="mf">.45</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">.925</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">.925</span><span class="p">],[</span><span class="mf">.9</span><span class="p">,</span><span class="mf">.9</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">.9</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mf">.925</span><span class="p">,</span><span class="mf">.925</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">.9</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">4.5</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">cbaxes</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.95</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Asset Wealth&#39;</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cbaxes</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/asset_wealth_prognosis_21_0.png" src="_images/asset_wealth_prognosis_21_0.png" />
</div>
</div>
</section>
</section>
<section id="Rural-Data">
<h3>Rural Data<a class="headerlink" href="#Rural-Data" title="Permalink to this headline">#</a></h3>
<section id="Get-Label-Data">
<h4>Get Label Data<a class="headerlink" href="#Get-Label-Data" title="Permalink to this headline">#</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wealth_df</span> <span class="o">=</span> <span class="n">combine_wealth_dfs</span><span class="p">(</span><span class="s1">&#39;/home/stoermer/Sentinel/gps_csv/&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train_val</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train_val</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">create_splits</span><span class="p">(</span><span class="n">img_dir</span><span class="o">=</span><span class="s1">&#39;/mnt/datadisk/data/VIIRS/preprocessed/asset/rural/all/&#39;</span><span class="p">,</span> <span class="n">wealth_path</span><span class="o">=</span><span class="s1">&#39;/home/stoermer/Sentinel/gps_csv/&#39;</span><span class="p">,</span> <span class="n">urban_rural</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">pre2015_path</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Gathering Label Data
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|███████████████████████████████████████████████████████████████████████████████| 5602/5602 [02:25&lt;00:00, 38.55it/s]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rural_test_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">X_test</span><span class="p">):</span>
    <span class="n">rural_test_labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">rural_test_labels</span><span class="p">,</span> <span class="n">get_label_for_img</span><span class="p">(</span><span class="n">wealth_df</span><span class="p">,</span> <span class="n">x</span><span class="p">)])</span>
<span class="n">rural_test_labels</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8e0c4d496e6341aa923856557cf4d0f1", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>WEALTH_INDEX</th>
      <th>SURVEY_YEAR</th>
      <th>LATNUM</th>
      <th>LONGNUM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.688140</td>
      <td>2015</td>
      <td>-17.7214</td>
      <td>31.7259</td>
    </tr>
    <tr>
      <th>0</th>
      <td>-0.216390</td>
      <td>2014</td>
      <td>-0.6815</td>
      <td>35.2460</td>
    </tr>
    <tr>
      <th>0</th>
      <td>-0.112214</td>
      <td>2016</td>
      <td>7.2301</td>
      <td>35.3157</td>
    </tr>
    <tr>
      <th>0</th>
      <td>-0.212770</td>
      <td>2015</td>
      <td>-12.9103</td>
      <td>34.2767</td>
    </tr>
    <tr>
      <th>0</th>
      <td>-0.168055</td>
      <td>2016</td>
      <td>-8.4875</td>
      <td>39.2632</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>-0.734604</td>
      <td>2014</td>
      <td>1.9172</td>
      <td>33.6136</td>
    </tr>
    <tr>
      <th>0</th>
      <td>-0.500560</td>
      <td>2015</td>
      <td>-1.7555</td>
      <td>29.6134</td>
    </tr>
    <tr>
      <th>0</th>
      <td>-0.504263</td>
      <td>2015</td>
      <td>-16.4775</td>
      <td>30.4724</td>
    </tr>
    <tr>
      <th>0</th>
      <td>-0.375565</td>
      <td>2014</td>
      <td>0.0005</td>
      <td>37.9925</td>
    </tr>
    <tr>
      <th>0</th>
      <td>-0.537768</td>
      <td>2015</td>
      <td>-4.4555</td>
      <td>39.2872</td>
    </tr>
  </tbody>
</table>
<p>1121 rows × 4 columns</p>
</div></div>
</div>
</section>
<section id="id1">
<h4>Get Predictions of Best Model<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;./resnet50_r_viirs.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_rural</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">X_test</span><span class="p">)):</span>
    <span class="c1"># Read in each Image</span>
    <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">viirs_path</span><span class="p">,</span> <span class="n">img</span><span class="p">))</span> <span class="k">as</span> <span class="n">i</span><span class="p">:</span>
        <span class="n">array</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>

    <span class="c1"># Ensure that the Array is not empty</span>
    <span class="n">array</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">array</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">array</span><span class="p">)),</span> <span class="s2">&quot;Float&quot;</span>

    <span class="c1"># Add to batch</span>
    <span class="n">data_rural</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span>

    <span class="c1"># Check if batch is already full (Note: Index in batch array is from 0...4 hence we need to add +1 to batch_ele)</span>
<span class="n">data_rural</span> <span class="o">=</span> <span class="n">data_rural</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">preds_rural</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_rural</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">preds_rural</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d85c6bf5602648a784d41bf88ecd8f4e", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1121
</pre></div></div>
</div>
</section>
<section id="id2">
<h4>Create Geo DataFrames for Groundtruth and Predictions<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crs</span> <span class="o">=</span> <span class="n">CRS</span><span class="p">(</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span>
<span class="n">geometry</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">points_from_xy</span><span class="p">(</span><span class="n">rural_test_labels</span><span class="o">.</span><span class="n">LONGNUM</span><span class="p">,</span> <span class="n">rural_test_labels</span><span class="o">.</span><span class="n">LATNUM</span><span class="p">)</span>

<span class="n">true_rural_wealth_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">rural_test_labels</span><span class="p">,</span>
                       <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span>
                       <span class="n">crs</span><span class="o">=</span><span class="n">crs</span>
                      <span class="p">)</span>
<span class="n">true_rural_wealth_df</span><span class="p">[</span><span class="s1">&#39;COUNTRY_CODE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X_test</span><span class="p">]</span>
<span class="n">true_rural_wealth_df</span> <span class="o">=</span> <span class="n">true_rural_wealth_df</span><span class="p">[[</span><span class="s1">&#39;SURVEY_YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="s1">&#39;COUNTRY_CODE&#39;</span><span class="p">,</span><span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">]]</span>
<span class="n">true_rural_wealth_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SURVEY_YEAR</th>
      <th>geometry</th>
      <th>COUNTRY_CODE</th>
      <th>WEALTH_INDEX</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015</td>
      <td>POINT (31.72590 -17.72140)</td>
      <td>ZWE</td>
      <td>-0.688140</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2014</td>
      <td>POINT (35.24600 -0.68150)</td>
      <td>KEN</td>
      <td>-0.216390</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2016</td>
      <td>POINT (35.31570 7.23010)</td>
      <td>ETH</td>
      <td>-0.112214</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_rural_wealth_df</span> <span class="o">=</span> <span class="n">true_rural_wealth_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;SURVEY_YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="s1">&#39;COUNTRY_CODE&#39;</span><span class="p">]]</span>
<span class="n">predicted_rural_wealth_df</span><span class="p">[</span><span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">preds_rural</span>
<span class="n">predicted_rural_wealth_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SURVEY_YEAR</th>
      <th>geometry</th>
      <th>COUNTRY_CODE</th>
      <th>WEALTH_INDEX</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015</td>
      <td>POINT (31.72590 -17.72140)</td>
      <td>ZWE</td>
      <td>-0.548155</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2014</td>
      <td>POINT (35.24600 -0.68150)</td>
      <td>KEN</td>
      <td>-0.588530</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2016</td>
      <td>POINT (35.31570 7.23010)</td>
      <td>ETH</td>
      <td>-0.588530</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="id3">
<h4>Plot Predictions vs. Groundtruth<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">divnorm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">TwoSlopeNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">vcenter</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">4.5</span><span class="p">)</span>
<span class="c1"># plt.subplots_adjust(wspace=None, hspace=None)</span>
<span class="n">markersize</span><span class="o">=</span><span class="mi">7</span>
<span class="n">predicted_countries_gdf</span> <span class="o">=</span> <span class="n">countries_gdf</span><span class="p">[</span><span class="n">countries_gdf</span><span class="o">.</span><span class="n">iso_a3</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">true_rural_wealth_df</span><span class="o">.</span><span class="n">COUNTRY_CODE</span><span class="p">)]</span>

<span class="n">mosaic</span> <span class="o">=</span>  <span class="p">[[</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2015&#39;</span><span class="p">,</span><span class="s1">&#39;title_2015&#39;</span><span class="p">,</span><span class="s1">&#39;title_2015&#39;</span><span class="p">,</span><span class="s1">&#39;title_2015&#39;</span><span class="p">,</span><span class="s1">&#39;title_2015&#39;</span><span class="p">,</span><span class="s1">&#39;title_2015&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;true2012&#39;</span><span class="p">,</span><span class="s1">&#39;true2012&#39;</span><span class="p">,</span><span class="s1">&#39;true2012&#39;</span><span class="p">,</span><span class="s1">&#39;pred2012&#39;</span><span class="p">,</span><span class="s1">&#39;pred2012&#39;</span><span class="p">,</span><span class="s1">&#39;pred2012&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;true2013&#39;</span><span class="p">,</span> <span class="s1">&#39;true2013&#39;</span><span class="p">,</span><span class="s1">&#39;true2013&#39;</span><span class="p">,</span><span class="s1">&#39;pred2013&#39;</span><span class="p">,</span><span class="s1">&#39;pred2013&#39;</span><span class="p">,</span><span class="s1">&#39;pred2013&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;true2014&#39;</span><span class="p">,</span><span class="s1">&#39;true2014&#39;</span><span class="p">,</span><span class="s1">&#39;true2014&#39;</span><span class="p">,</span><span class="s1">&#39;pred2014&#39;</span><span class="p">,</span><span class="s1">&#39;pred2014&#39;</span><span class="p">,</span><span class="s1">&#39;pred2014&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
        <span class="s1">&#39;true2015&#39;</span><span class="p">,</span><span class="s1">&#39;true2015&#39;</span><span class="p">,</span><span class="s1">&#39;true2015&#39;</span><span class="p">,</span><span class="s1">&#39;pred2015&#39;</span><span class="p">,</span><span class="s1">&#39;pred2015&#39;</span><span class="p">,</span><span class="s1">&#39;pred2015&#39;</span><span class="p">],</span>
           <span class="p">[</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2020&#39;</span><span class="p">,</span><span class="s1">&#39;title_2020&#39;</span><span class="p">,</span><span class="s1">&#39;title_2020&#39;</span><span class="p">,</span><span class="s1">&#39;title_2020&#39;</span><span class="p">,</span><span class="s1">&#39;title_2020&#39;</span><span class="p">,</span><span class="s1">&#39;title_2020&#39;</span><span class="p">],</span>
           <span class="p">[</span><span class="s1">&#39;true2016&#39;</span><span class="p">,</span><span class="s1">&#39;true2016&#39;</span><span class="p">,</span><span class="s1">&#39;true2016&#39;</span><span class="p">,</span><span class="s1">&#39;pred2016&#39;</span><span class="p">,</span><span class="s1">&#39;pred2016&#39;</span><span class="p">,</span><span class="s1">&#39;pred2016&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;true2018&#39;</span><span class="p">,</span><span class="s1">&#39;true2018&#39;</span><span class="p">,</span><span class="s1">&#39;true2018&#39;</span><span class="p">,</span> <span class="s1">&#39;pred2018&#39;</span><span class="p">,</span> <span class="s1">&#39;pred2018&#39;</span><span class="p">,</span><span class="s1">&#39;pred2018&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;true2019&#39;</span><span class="p">,</span><span class="s1">&#39;true2019&#39;</span><span class="p">,</span><span class="s1">&#39;true2019&#39;</span><span class="p">,</span><span class="s1">&#39;pred2019&#39;</span><span class="p">,</span><span class="s1">&#39;pred2019&#39;</span><span class="p">,</span><span class="s1">&#39;pred2019&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;true2020&#39;</span><span class="p">,</span> <span class="s1">&#39;true2020&#39;</span><span class="p">,</span> <span class="s1">&#39;true2020&#39;</span><span class="p">,</span><span class="s1">&#39;pred2020&#39;</span><span class="p">,</span><span class="s1">&#39;pred2020&#39;</span><span class="p">,</span><span class="s1">&#39;pred2020&#39;</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">(</span><span class="n">mosaic</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">height_ratios</span><span class="o">=</span><span class="p">(</span><span class="mf">.8</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mi">3</span><span class="p">))))</span><span class="c1">#, constrained_layout=True)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Vergleich der Vorhersagen und wahren Labels für das rurale Testset&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mosaic</span><span class="p">):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">row</span> <span class="k">if</span> <span class="n">k</span><span class="o">!=</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
    <span class="n">keys</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="c1">#     print(keys)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
        <span class="n">predicted_countries_gdf</span> <span class="o">=</span> <span class="n">countries_gdf</span><span class="p">[</span><span class="n">countries_gdf</span><span class="o">.</span><span class="n">iso_a3</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">true_rural_wealth_df</span><span class="p">[</span><span class="n">true_rural_wealth_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])]</span><span class="o">.</span><span class="n">COUNTRY_CODE</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">y</span><span class="o">=-</span><span class="mf">5.5</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;true&#39;</span><span class="p">):</span>
            <span class="n">predicted_countries_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
            <span class="n">true_rural_wealth_df</span><span class="p">[</span><span class="n">true_rural_wealth_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">predicted_countries_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
            <span class="n">predicted_rural_wealth_df</span><span class="p">[</span><span class="n">predicted_rural_wealth_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>

<span class="n">line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">.925</span><span class="p">],[</span><span class="mf">.45</span><span class="p">,</span><span class="mf">.45</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">.925</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">.925</span><span class="p">],[</span><span class="mf">.9</span><span class="p">,</span><span class="mf">.9</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">.9</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mf">.925</span><span class="p">,</span><span class="mf">.925</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">.9</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">4.5</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">cbaxes</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.95</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Asset Wealth&#39;</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cbaxes</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/asset_wealth_prognosis_33_0.png" src="_images/asset_wealth_prognosis_33_0.png" />
</div>
</div>
</section>
</section>
</section>
<section id="Combine-rural-and-urban-predictions-and-labels">
<h2>Combine rural and urban predictions and labels<a class="headerlink" href="#Combine-rural-and-urban-predictions-and-labels" title="Permalink to this headline">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_wealth_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">predicted_rural_wealth_df</span><span class="p">,</span><span class="n">predicted_urban_wealth_df</span><span class="p">])</span>
<span class="n">true_wealth_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">true_rural_wealth_df</span><span class="p">,</span> <span class="n">true_urban_wealth_df</span><span class="p">])</span>
</pre></div>
</div>
</div>
<section id="Plot-all-predictions">
<h3>Plot all predictions<a class="headerlink" href="#Plot-all-predictions" title="Permalink to this headline">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">divnorm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">TwoSlopeNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">vcenter</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">4.5</span><span class="p">)</span>
<span class="n">markersize</span><span class="o">=</span><span class="mi">5</span>
<span class="n">predicted_countries_gdf</span> <span class="o">=</span> <span class="n">countries_gdf</span><span class="p">[</span><span class="n">countries_gdf</span><span class="o">.</span><span class="n">iso_a3</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">true_rural_wealth_df</span><span class="o">.</span><span class="n">COUNTRY_CODE</span><span class="p">)]</span>

<span class="n">mosaic</span> <span class="o">=</span>  <span class="p">[[</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;title_2012&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;title_2013&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;title_2014&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2015&#39;</span><span class="p">,</span><span class="s1">&#39;title_2015&#39;</span><span class="p">,</span><span class="s1">&#39;title_2015&#39;</span><span class="p">,</span><span class="s1">&#39;title_2015&#39;</span><span class="p">,</span><span class="s1">&#39;title_2015&#39;</span><span class="p">,</span><span class="s1">&#39;title_2015&#39;</span><span class="p">],</span>
        <span class="p">[</span><span class="s1">&#39;true2012&#39;</span><span class="p">,</span><span class="s1">&#39;true2012&#39;</span><span class="p">,</span><span class="s1">&#39;true2012&#39;</span><span class="p">,</span><span class="s1">&#39;pred2012&#39;</span><span class="p">,</span><span class="s1">&#39;pred2012&#39;</span><span class="p">,</span><span class="s1">&#39;pred2012&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;true2013&#39;</span><span class="p">,</span> <span class="s1">&#39;true2013&#39;</span><span class="p">,</span><span class="s1">&#39;true2013&#39;</span><span class="p">,</span><span class="s1">&#39;pred2013&#39;</span><span class="p">,</span><span class="s1">&#39;pred2013&#39;</span><span class="p">,</span><span class="s1">&#39;pred2013&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;true2014&#39;</span><span class="p">,</span><span class="s1">&#39;true2014&#39;</span><span class="p">,</span><span class="s1">&#39;true2014&#39;</span><span class="p">,</span><span class="s1">&#39;pred2014&#39;</span><span class="p">,</span><span class="s1">&#39;pred2014&#39;</span><span class="p">,</span><span class="s1">&#39;pred2014&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
        <span class="s1">&#39;true2015&#39;</span><span class="p">,</span><span class="s1">&#39;true2015&#39;</span><span class="p">,</span><span class="s1">&#39;true2015&#39;</span><span class="p">,</span><span class="s1">&#39;pred2015&#39;</span><span class="p">,</span><span class="s1">&#39;pred2015&#39;</span><span class="p">,</span><span class="s1">&#39;pred2015&#39;</span><span class="p">],</span>
           <span class="p">[</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;title_2016&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;title_2018&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;title_2019&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;title_2020&#39;</span><span class="p">,</span><span class="s1">&#39;title_2020&#39;</span><span class="p">,</span><span class="s1">&#39;title_2020&#39;</span><span class="p">,</span><span class="s1">&#39;title_2020&#39;</span><span class="p">,</span><span class="s1">&#39;title_2020&#39;</span><span class="p">,</span><span class="s1">&#39;title_2020&#39;</span><span class="p">],</span>
           <span class="p">[</span><span class="s1">&#39;true2016&#39;</span><span class="p">,</span><span class="s1">&#39;true2016&#39;</span><span class="p">,</span><span class="s1">&#39;true2016&#39;</span><span class="p">,</span><span class="s1">&#39;pred2016&#39;</span><span class="p">,</span><span class="s1">&#39;pred2016&#39;</span><span class="p">,</span><span class="s1">&#39;pred2016&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;true2018&#39;</span><span class="p">,</span><span class="s1">&#39;true2018&#39;</span><span class="p">,</span><span class="s1">&#39;true2018&#39;</span><span class="p">,</span> <span class="s1">&#39;pred2018&#39;</span><span class="p">,</span> <span class="s1">&#39;pred2018&#39;</span><span class="p">,</span><span class="s1">&#39;pred2018&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;true2019&#39;</span><span class="p">,</span><span class="s1">&#39;true2019&#39;</span><span class="p">,</span><span class="s1">&#39;true2019&#39;</span><span class="p">,</span><span class="s1">&#39;pred2019&#39;</span><span class="p">,</span><span class="s1">&#39;pred2019&#39;</span><span class="p">,</span><span class="s1">&#39;pred2019&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;true2020&#39;</span><span class="p">,</span> <span class="s1">&#39;true2020&#39;</span><span class="p">,</span> <span class="s1">&#39;true2020&#39;</span><span class="p">,</span><span class="s1">&#39;pred2020&#39;</span><span class="p">,</span><span class="s1">&#39;pred2020&#39;</span><span class="p">,</span><span class="s1">&#39;pred2020&#39;</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot_mosaic</span><span class="p">(</span><span class="n">mosaic</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">height_ratios</span><span class="o">=</span><span class="p">(</span><span class="mf">.8</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">.8</span><span class="p">,</span><span class="mi">3</span><span class="p">))))</span><span class="c1">#, constrained_layout=True)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Vergleich der Vorhersagen und wahren Labels für das rurale Testset&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mosaic</span><span class="p">):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">row</span> <span class="k">if</span> <span class="n">k</span><span class="o">!=</span><span class="s1">&#39;.&#39;</span><span class="p">]</span>
    <span class="n">keys</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
        <span class="n">predicted_countries_gdf</span> <span class="o">=</span> <span class="n">countries_gdf</span><span class="p">[</span><span class="n">countries_gdf</span><span class="o">.</span><span class="n">iso_a3</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">true_wealth_df</span><span class="p">[</span><span class="n">true_wealth_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])]</span><span class="o">.</span><span class="n">COUNTRY_CODE</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">y</span><span class="o">=-</span><span class="mf">5.5</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;true&#39;</span><span class="p">):</span>
            <span class="n">predicted_countries_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
            <span class="n">true_wealth_df</span><span class="p">[</span><span class="n">true_wealth_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">predicted_countries_gdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
            <span class="n">predicted_wealth_df</span><span class="p">[</span><span class="n">predicted_wealth_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">([])</span>

<span class="n">line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">.925</span><span class="p">],[</span><span class="mf">.45</span><span class="p">,</span><span class="mf">.45</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">.925</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">.925</span><span class="p">],[</span><span class="mf">.9</span><span class="p">,</span><span class="mf">.9</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">.9</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Line2D</span><span class="p">([</span><span class="mf">.925</span><span class="p">,</span><span class="mf">.925</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">.9</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">4.5</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">4.5</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">cbaxes</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.95</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Asset Wealth&#39;</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cbaxes</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/asset_wealth_prognosis_37_0.png" src="_images/asset_wealth_prognosis_37_0.png" />
</div>
</div>
</section>
<section id="Get-r2-Score-for-best-Models">
<h3>Get r2 Score for best Models<a class="headerlink" href="#Get-r2-Score-for-best-Models" title="Permalink to this headline">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>


<span class="n">urban_r2_score</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">true_urban_wealth_df</span><span class="o">.</span><span class="n">WEALTH_INDEX</span><span class="p">,</span> <span class="n">predicted_urban_wealth_df</span><span class="o">.</span><span class="n">WEALTH_INDEX</span><span class="p">)</span>
<span class="n">rural_r2_score</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">true_rural_wealth_df</span><span class="o">.</span><span class="n">WEALTH_INDEX</span><span class="p">,</span> <span class="n">predicted_rural_wealth_df</span><span class="o">.</span><span class="n">WEALTH_INDEX</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">urban_r2_score</span><span class="p">)</span>
<span class="n">rural_r2_score</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.32608796277450536
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.14404635936378374
</pre></div></div>
</div>
</section>
<section id="Save-Predictions-and-Groundtruth">
<h3>Save Predictions and Groundtruth<a class="headerlink" href="#Save-Predictions-and-Groundtruth" title="Permalink to this headline">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_urban_wealth_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./predicted_urban_wealth_df.csv&#39;</span><span class="p">)</span>
<span class="n">true_urban_wealth_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./true_urban_wealth_df.csv&#39;</span><span class="p">)</span>

<span class="n">predicted_rural_wealth_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./predicted_rural_wealth_df.csv&#39;</span><span class="p">)</span>
<span class="n">true_rural_wealth_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./true_rural_wealth_df.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_urban_wealth_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./predicted_urban_wealth_df.csv&#39;</span><span class="p">)[[</span><span class="s1">&#39;SURVEY_YEAR&#39;</span><span class="p">,</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">]]</span>
<span class="n">predicted_urban_wealth_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">predicted_urban_wealth_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">predicted_urban_wealth_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]],</span>
                                             <span class="n">geometry</span><span class="o">=</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="o">.</span><span class="n">from_wkt</span><span class="p">(</span><span class="n">predicted_urban_wealth_df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]),</span>
                                             <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span>
                                            <span class="p">)</span>

<span class="n">true_urban_wealth_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./true_urban_wealth_df.csv&#39;</span><span class="p">)[[</span><span class="s1">&#39;SURVEY_YEAR&#39;</span><span class="p">,</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span><span class="s1">&#39;COUNTRY_CODE&#39;</span><span class="p">,</span> <span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">]]</span>
<span class="n">true_urban_wealth_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">true_urban_wealth_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">true_urban_wealth_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]],</span>
                                        <span class="n">geometry</span><span class="o">=</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="o">.</span><span class="n">from_wkt</span><span class="p">(</span><span class="n">true_urban_wealth_df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]),</span>
                                        <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span>
                                       <span class="p">)</span>


<span class="n">predicted_rural_wealth_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./predicted_rural_wealth_df.csv&#39;</span><span class="p">)[[</span><span class="s1">&#39;SURVEY_YEAR&#39;</span><span class="p">,</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">]]</span>
<span class="n">predicted_rural_wealth_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">predicted_rural_wealth_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">predicted_rural_wealth_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]],</span>
                                             <span class="n">geometry</span><span class="o">=</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="o">.</span><span class="n">from_wkt</span><span class="p">(</span><span class="n">predicted_rural_wealth_df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]),</span>
                                             <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span>
                                            <span class="p">)</span>

<span class="n">true_rural_wealth_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./true_rural_wealth_df.csv&#39;</span><span class="p">)[[</span><span class="s1">&#39;SURVEY_YEAR&#39;</span><span class="p">,</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span><span class="s1">&#39;COUNTRY_CODE&#39;</span><span class="p">,</span> <span class="s1">&#39;WEALTH_INDEX&#39;</span><span class="p">]]</span>
<span class="n">true_rural_wealth_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">true_rural_wealth_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">true_rural_wealth_df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="o">!=</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]],</span>
                                        <span class="n">geometry</span><span class="o">=</span><span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="o">.</span><span class="n">from_wkt</span><span class="p">(</span><span class="n">true_rural_wealth_df</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]),</span>
                                        <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">,</span>
                                       <span class="p">)</span>
<br/></pre></div>
</div>
</div>
</section>
</section>
<section id="Predict-Asset-Wealth-for-Mozambique">
<h2>Predict Asset Wealth for Mozambique<a class="headerlink" href="#Predict-Asset-Wealth-for-Mozambique" title="Permalink to this headline">#</a></h2>
<section id="Load-general-geographic-Data-of-Mozambique">
<h3>Load general geographic Data of Mozambique<a class="headerlink" href="#Load-general-geographic-Data-of-Mozambique" title="Permalink to this headline">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">gpd</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="s1">&#39;naturalearth_lowres&#39;</span><span class="p">))</span>
<span class="n">moz</span> <span class="o">=</span> <span class="n">world</span><span class="p">[</span><span class="n">world</span><span class="o">.</span><span class="n">name</span><span class="o">==</span><span class="s1">&#39;Mozambique&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Load-Mozambique-Survey-Data">
<h2>Load Mozambique Survey Data<a class="headerlink" href="#Load-Mozambique-Survey-Data" title="Permalink to this headline">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moz_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./moz_2016_2021.csv&#39;</span><span class="p">)</span>
<span class="n">moz_df</span> <span class="o">=</span> <span class="n">moz_df</span><span class="p">[[</span><span class="s1">&#39;URBAN_RURA&#39;</span><span class="p">,</span> <span class="s1">&#39;LATNUM&#39;</span><span class="p">,</span> <span class="s1">&#39;LONGNUM&#39;</span><span class="p">,</span> <span class="s1">&#39;SURVEY_YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;Filename&#39;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">moz_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">moz_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(2635, 5)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>URBAN_RURA</th>
      <th>LATNUM</th>
      <th>LONGNUM</th>
      <th>SURVEY_YEAR</th>
      <th>Filename</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>-13.2856</td>
      <td>35.2311</td>
      <td>2016</td>
      <td>-13.2856_35.2311_20160101-20161231_MOZ_u_2.0.tif</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>-13.3226</td>
      <td>35.2552</td>
      <td>2016</td>
      <td>-13.3226_35.2552_20160101-20161231_MOZ_u_2.0.tif</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>-13.2716</td>
      <td>35.1965</td>
      <td>2016</td>
      <td>-13.2716_35.1965_20160101-20161231_MOZ_u_2.0.tif</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Urban">
<h2>Urban<a class="headerlink" href="#Urban" title="Permalink to this headline">#</a></h2>
<section id="Load-Data-for-Mozambique-2016,-2017,-2019,-2020-and-2021">
<h3>Load Data for Mozambique 2016, 2017, 2019, 2020 and 2021<a class="headerlink" href="#Load-Data-for-Mozambique-2016,-2017,-2019,-2020-and-2021" title="Permalink to this headline">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;./vgg19_viirs_s2_u.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moz_path_urban</span> <span class="o">=</span> <span class="s1">&#39;/mnt/datadisk/data/VIIRS_Sentinel2/asset/urban/mozambique_2016_2021&#39;</span>
<span class="n">moz_list_urban</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">moz_path_urban</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">moz_list_urban</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1115
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moz_2016_urban</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">moz_list_urban</span> <span class="k">if</span> <span class="s1">&#39;2016&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
<span class="n">moz_2017_urban</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">moz_list_urban</span> <span class="k">if</span> <span class="s1">&#39;2017&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
<span class="n">moz_2019_urban</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">moz_list_urban</span> <span class="k">if</span> <span class="s1">&#39;2019&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
<span class="n">moz_2020_urban</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">moz_list_urban</span> <span class="k">if</span> <span class="s1">&#39;2020&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
<span class="n">moz_2021_urban</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">moz_list_urban</span> <span class="k">if</span> <span class="s1">&#39;2021&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_urban</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">moz_data_urban</span> <span class="ow">in</span> <span class="p">[[</span><span class="n">moz_2016_urban</span><span class="p">,</span><span class="s1">&#39;2016&#39;</span><span class="p">],[</span><span class="n">moz_2017_urban</span><span class="p">,</span><span class="s1">&#39;2017&#39;</span><span class="p">],[</span><span class="n">moz_2019_urban</span><span class="p">,</span><span class="s1">&#39;2019&#39;</span><span class="p">],[</span><span class="n">moz_2020_urban</span><span class="p">,</span><span class="s1">&#39;2020&#39;</span><span class="p">],[</span><span class="n">moz_2021_urban</span><span class="p">,</span><span class="s1">&#39;2021&#39;</span><span class="p">]]:</span>
    <span class="n">data_urban</span><span class="p">[</span><span class="n">moz_data_urban</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">moz_data_urban</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">moz_data_urban</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
        <span class="c1"># Read in each Image</span>
        <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">moz_path_urban</span><span class="p">,</span> <span class="n">img</span><span class="p">))</span> <span class="k">as</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>

        <span class="c1"># Ensure that the Array is not empty</span>
        <span class="n">array</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">array</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">array</span><span class="p">)),</span> <span class="s2">&quot;Float&quot;</span>

        <span class="n">data_urban</span><span class="p">[</span><span class="n">moz_data_urban</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span>

    <span class="n">data_urban</span><span class="p">[</span><span class="n">moz_data_urban</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data_urban</span><span class="p">[</span><span class="n">moz_data_urban</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_urban</span><span class="p">[</span><span class="n">moz_data_urban</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">moz_data_urban</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2175dbf6441a4548a7545391df5ef4a0", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "ddadd28f22254ccb9a440ee0a3c49cd3", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "060b76a8c87f4af58b3fec040324b8c1", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8883cdca96de40b4b2bcf056e4366dfa", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f3d30732731741168ee4ebbe74e3fb4c", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="Predict-Asset-Wealth">
<h3>Predict Asset Wealth<a class="headerlink" href="#Predict-Asset-Wealth" title="Permalink to this headline">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preds_urban</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">data_urban</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="n">preds_urban</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_urban</span><span class="p">[</span><span class="n">year</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">preds_urban</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">len</span><span class="p">(</span><span class="n">preds_urban</span><span class="p">[</span><span class="s1">&#39;2016&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7c3bb21bb164426993ca00ccff923d3b", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([&#39;2016&#39;, &#39;2017&#39;, &#39;2019&#39;, &#39;2020&#39;, &#39;2021&#39;])
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
223
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred_file_urban_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Filename&#39;</span><span class="p">:</span><span class="n">moz_2016_urban</span><span class="o">+</span><span class="n">moz_2017_urban</span><span class="o">+</span><span class="n">moz_2019_urban</span><span class="o">+</span><span class="n">moz_2020_urban</span><span class="o">+</span><span class="n">moz_2021_urban</span><span class="p">,</span>
                 <span class="s1">&#39;Prediction&#39;</span><span class="p">:[</span><span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">preds_urban</span><span class="p">[</span><span class="s1">&#39;2016&#39;</span><span class="p">]]</span><span class="o">+</span>
                 <span class="p">[</span><span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">preds_urban</span><span class="p">[</span><span class="s1">&#39;2017&#39;</span><span class="p">]]</span><span class="o">+</span>
                 <span class="p">[</span><span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">preds_urban</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">]]</span><span class="o">+</span>
                 <span class="p">[</span><span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">preds_urban</span><span class="p">[</span><span class="s1">&#39;2020&#39;</span><span class="p">]]</span><span class="o">+</span>
                 <span class="p">[</span><span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">preds_urban</span><span class="p">[</span><span class="s1">&#39;2021&#39;</span><span class="p">]]}</span>
<span class="n">pred_file_urban_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_file_urban_dict</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pred_file_urban_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">pred_file_urban_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1115, 2)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Filename</th>
      <th>Prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-25.9443_32.6146_20160101-20161231_MOZ_u_2.0.tif</td>
      <td>1.961596</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-25.9002_32.6141_20160101-20161231_MOZ_u_2.0.tif</td>
      <td>1.722382</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-23.7538_35.3463_20160101-20161231_MOZ_u_2.0.tif</td>
      <td>1.993611</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Merge-Predictions-with-Survey-Data">
<h3>Merge Predictions with Survey Data<a class="headerlink" href="#Merge-Predictions-with-Survey-Data" title="Permalink to this headline">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asset_pred_urban_df</span> <span class="o">=</span> <span class="n">moz_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">pred_file_urban_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">asset_pred_urban_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">asset_pred_urban_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1115, 6)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>URBAN_RURA</th>
      <th>LATNUM</th>
      <th>LONGNUM</th>
      <th>SURVEY_YEAR</th>
      <th>Filename</th>
      <th>Prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>-13.2856</td>
      <td>35.2311</td>
      <td>2016</td>
      <td>-13.2856_35.2311_20160101-20161231_MOZ_u_2.0.tif</td>
      <td>1.521431</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>-13.3226</td>
      <td>35.2552</td>
      <td>2016</td>
      <td>-13.3226_35.2552_20160101-20161231_MOZ_u_2.0.tif</td>
      <td>1.153307</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>-13.2716</td>
      <td>35.1965</td>
      <td>2016</td>
      <td>-13.2716_35.1965_20160101-20161231_MOZ_u_2.0.tif</td>
      <td>1.414657</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="id4">
<h3>Merge Predictions with Survey Data<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geometry</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">points_from_xy</span><span class="p">(</span><span class="n">asset_pred_urban_df</span><span class="o">.</span><span class="n">LONGNUM</span><span class="p">,</span> <span class="n">asset_pred_urban_df</span><span class="o">.</span><span class="n">LATNUM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asset_pred_urban_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">asset_pred_urban_df</span><span class="p">,</span>
                       <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span>
                       <span class="n">crs</span><span class="o">=</span><span class="n">crs</span>
                      <span class="p">)</span>
<span class="n">asset_pred_urban_df</span> <span class="o">=</span> <span class="n">asset_pred_urban_df</span><span class="p">[[</span><span class="s1">&#39;SURVEY_YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="s1">&#39;Prediction&#39;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">asset_pred_urban_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">asset_pred_urban_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1115, 3)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SURVEY_YEAR</th>
      <th>geometry</th>
      <th>Prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016</td>
      <td>POINT (35.23110 -13.28560)</td>
      <td>1.521431</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016</td>
      <td>POINT (35.25520 -13.32260)</td>
      <td>1.153307</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016</td>
      <td>POINT (35.19650 -13.27160)</td>
      <td>1.414657</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">urban_2016_df</span> <span class="o">=</span> <span class="n">asset_pred_urban_df</span><span class="p">[</span><span class="n">asset_pred_urban_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="mi">2016</span><span class="p">]</span>
<span class="n">urban_2016_df</span><span class="o">.</span><span class="n">shape</span>

<span class="n">urban_2017_df</span> <span class="o">=</span> <span class="n">asset_pred_urban_df</span><span class="p">[</span><span class="n">asset_pred_urban_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="mi">2017</span><span class="p">]</span>
<span class="n">urban_2017_df</span><span class="o">.</span><span class="n">shape</span>

<span class="n">urban_2019_df</span> <span class="o">=</span> <span class="n">asset_pred_urban_df</span><span class="p">[</span><span class="n">asset_pred_urban_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="mi">2019</span><span class="p">]</span>
<span class="n">urban_2019_df</span><span class="o">.</span><span class="n">shape</span>

<span class="n">urban_2020_df</span> <span class="o">=</span> <span class="n">asset_pred_urban_df</span><span class="p">[</span><span class="n">asset_pred_urban_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="mi">2020</span><span class="p">]</span>
<span class="n">urban_2020_df</span><span class="o">.</span><span class="n">shape</span>

<span class="n">urban_2021_df</span> <span class="o">=</span> <span class="n">asset_pred_urban_df</span><span class="p">[</span><span class="n">asset_pred_urban_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="mi">2021</span><span class="p">]</span>
<span class="n">urban_2021_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(223, 3)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>


<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span>

<span class="n">divnorm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">TwoSlopeNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">vcenter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">markersize</span><span class="o">=</span><span class="mi">5</span>
<span class="n">subplot_title_size</span> <span class="o">=</span> <span class="mi">16</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Asset Wealth Verteilung der besten Modelle für Mosambik&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.53</span><span class="p">)</span>

<span class="n">moz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>

<span class="n">urban_2016_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>


<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mosambik 2016&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">subplot_title_size</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">moz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">urban_2017_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>


<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mosambik 2017&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">subplot_title_size</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">moz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">urban_2019_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mosambik 2019&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">subplot_title_size</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">moz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">urban_2020_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mosambik 2020&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">subplot_title_size</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">moz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">urban_2021_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mosambik 2021&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">subplot_title_size</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">cbaxes</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.066</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">.92</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Asset Wealth&#39;</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cbaxes</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/asset_wealth_prognosis_61_0.png" src="_images/asset_wealth_prognosis_61_0.png" />
</div>
</div>
</section>
</section>
<section id="Rural">
<h2>Rural<a class="headerlink" href="#Rural" title="Permalink to this headline">#</a></h2>
<section id="id5">
<h3>Load Data for Mozambique 2016, 2017, 2019, 2020 and 2021<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;./resnet50_r_viirs.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moz_path_rural</span> <span class="o">=</span> <span class="s1">&#39;/mnt/datadisk/data/VIIRS/preprocessed/asset/rural/mozambique_2016_2021/prep&#39;</span>

<span class="n">moz_rural</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">moz_path_rural</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">moz_rural</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1520
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moz_2016_rural</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">moz_rural</span> <span class="k">if</span> <span class="s1">&#39;2016&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
<span class="n">moz_2017_rural</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">moz_rural</span> <span class="k">if</span> <span class="s1">&#39;2017&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
<span class="n">moz_2019_rural</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">moz_rural</span> <span class="k">if</span> <span class="s1">&#39;2019&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
<span class="n">moz_2020_rural</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">moz_rural</span> <span class="k">if</span> <span class="s1">&#39;2020&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
<span class="n">moz_2021_rural</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">moz_rural</span> <span class="k">if</span> <span class="s1">&#39;2021&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_rural</span><span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">moz_data_rural</span> <span class="ow">in</span> <span class="p">[[</span><span class="n">moz_2016_rural</span><span class="p">,</span><span class="s1">&#39;2016&#39;</span><span class="p">],[</span><span class="n">moz_2017_rural</span><span class="p">,</span><span class="s1">&#39;2017&#39;</span><span class="p">],[</span><span class="n">moz_2019_rural</span><span class="p">,</span><span class="s1">&#39;2019&#39;</span><span class="p">],[</span><span class="n">moz_2020_rural</span><span class="p">,</span><span class="s1">&#39;2020&#39;</span><span class="p">],[</span><span class="n">moz_2021_rural</span><span class="p">,</span><span class="s1">&#39;2021&#39;</span><span class="p">]]:</span>
    <span class="n">data_rural</span><span class="p">[</span><span class="n">moz_data_rural</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">moz_data_rural</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">moz_data_rural</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
        <span class="c1"># Read in each Image</span>
        <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">moz_path_rural</span><span class="p">,</span> <span class="n">img</span><span class="p">))</span> <span class="k">as</span> <span class="n">i</span><span class="p">:</span>
            <span class="n">array</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>

        <span class="c1"># Ensure that the Array is not empty</span>
        <span class="n">array</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">array</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">array</span><span class="p">)),</span> <span class="s2">&quot;Float&quot;</span>

        <span class="c1"># Add to batch</span>
        <span class="n">data_rural</span><span class="p">[</span><span class="n">moz_data_rural</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span>

        <span class="c1"># Check if batch is already full (Note: Index in batch array is from 0...4 hence we need to add +1 to batch_ele)</span>
    <span class="n">data_rural</span><span class="p">[</span><span class="n">moz_data_rural</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data_rural</span><span class="p">[</span><span class="n">moz_data_rural</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_rural</span><span class="p">[</span><span class="n">moz_data_rural</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">moz_data_rural</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a96347858db4472fb32dbaa193234e80", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "97aefa8b228647a39e33306a6e32acc1", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3848ce65c6094a8ea8e9beb37b292ad4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "aba483e12def4c34916a6a13bdf7e7df", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "144a951c5c2b48f498a7e7f95cdab6d8", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="id6">
<h3>Predict Asset Wealth<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">optimizers</span><span class="p">,</span> <span class="n">models</span>
<span class="n">preds_rural</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">data_rural</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="n">preds_rural</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_rural</span><span class="p">[</span><span class="n">year</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">preds_rural</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">len</span><span class="p">(</span><span class="n">preds_rural</span><span class="p">[</span><span class="s1">&#39;2016&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "860c38d180a542f0b3ff3a487ca76932", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([&#39;2016&#39;, &#39;2017&#39;, &#39;2019&#39;, &#39;2020&#39;, &#39;2021&#39;])
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
304
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred_rural_file_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Filename&#39;</span><span class="p">:</span>
                        <span class="n">moz_2016_rural</span><span class="o">+</span>
                        <span class="n">moz_2017_rural</span><span class="o">+</span>
                        <span class="n">moz_2019_rural</span><span class="o">+</span>
                        <span class="n">moz_2020_rural</span><span class="o">+</span>
                        <span class="n">moz_2021_rural</span><span class="p">,</span>
                        <span class="s1">&#39;Prediction&#39;</span><span class="p">:</span>
                        <span class="p">[</span><span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">preds_rural</span><span class="p">[</span><span class="s1">&#39;2016&#39;</span><span class="p">]]</span><span class="o">+</span>
                        <span class="p">[</span><span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">preds_rural</span><span class="p">[</span><span class="s1">&#39;2017&#39;</span><span class="p">]]</span><span class="o">+</span>
                        <span class="p">[</span><span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">preds_rural</span><span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">]]</span><span class="o">+</span>
                        <span class="p">[</span><span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">preds_rural</span><span class="p">[</span><span class="s1">&#39;2020&#39;</span><span class="p">]]</span><span class="o">+</span>
                        <span class="p">[</span><span class="n">pred</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">preds_rural</span><span class="p">[</span><span class="s1">&#39;2021&#39;</span><span class="p">]]}</span>
<span class="n">pred_rural_file_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pred_rural_file_dict</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pred_rural_file_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">pred_rural_file_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1520, 2)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Filename</th>
      <th>Prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-20.5253_34.0313_20160101-20161231_MOZ_r_10.0.tif</td>
      <td>-0.588530</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-14.4227_38.3001_20160101-20161231_MOZ_r_10.0.tif</td>
      <td>-0.469308</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-15.8257_38.5071_20160101-20161231_MOZ_r_10.0.tif</td>
      <td>-0.588530</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="id7">
<h3>Merge Predictions with Survey Data<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asset_pred_rural_df</span> <span class="o">=</span> <span class="n">moz_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">pred_rural_file_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">asset_pred_rural_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">asset_pred_rural_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1520, 6)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>URBAN_RURA</th>
      <th>LATNUM</th>
      <th>LONGNUM</th>
      <th>SURVEY_YEAR</th>
      <th>Filename</th>
      <th>Prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>-15.1365</td>
      <td>36.5967</td>
      <td>2016</td>
      <td>-15.1365_36.5967_20160101-20161231_MOZ_r_10.0.tif</td>
      <td>-0.266213</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>-14.6769</td>
      <td>36.4565</td>
      <td>2016</td>
      <td>-14.6769_36.4565_20160101-20161231_MOZ_r_10.0.tif</td>
      <td>-0.588530</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>-12.0948</td>
      <td>34.8491</td>
      <td>2016</td>
      <td>-12.0948_34.8491_20160101-20161231_MOZ_r_10.0.tif</td>
      <td>-0.588530</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Get-Geocoordinates-and-create-Geometry-Objects">
<h3>Get Geocoordinates and create Geometry Objects<a class="headerlink" href="#Get-Geocoordinates-and-create-Geometry-Objects" title="Permalink to this headline">#</a></h3>
</section>
<section id="id8">
<h3>Merge Predictions with Survey Data<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geometry</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">points_from_xy</span><span class="p">(</span><span class="n">asset_pred_rural_df</span><span class="o">.</span><span class="n">LONGNUM</span><span class="p">,</span> <span class="n">asset_pred_rural_df</span><span class="o">.</span><span class="n">LATNUM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asset_pred_rural_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">asset_pred_rural_df</span><span class="p">,</span>
                       <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span>
                       <span class="n">crs</span><span class="o">=</span><span class="n">crs</span>
                      <span class="p">)</span>
<span class="n">asset_pred_rural_df</span> <span class="o">=</span> <span class="n">asset_pred_rural_df</span><span class="p">[[</span><span class="s1">&#39;SURVEY_YEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="s1">&#39;Prediction&#39;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">asset_pred_rural_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">asset_pred_rural_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1520, 3)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SURVEY_YEAR</th>
      <th>geometry</th>
      <th>Prediction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016</td>
      <td>POINT (36.59670 -15.13650)</td>
      <td>-0.266213</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016</td>
      <td>POINT (36.45650 -14.67690)</td>
      <td>-0.588530</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016</td>
      <td>POINT (34.84910 -12.09480)</td>
      <td>-0.588530</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asset_pred_rural_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;./moz_rural_asset_wealth_prediction.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rural_2016_df</span> <span class="o">=</span> <span class="n">asset_pred_rural_df</span><span class="p">[</span><span class="n">asset_pred_rural_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="mi">2016</span><span class="p">]</span>
<span class="n">rural_2016_df</span><span class="o">.</span><span class="n">shape</span>

<span class="n">rural_2017_df</span> <span class="o">=</span> <span class="n">asset_pred_rural_df</span><span class="p">[</span><span class="n">asset_pred_rural_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="mi">2017</span><span class="p">]</span>
<span class="n">rural_2017_df</span><span class="o">.</span><span class="n">shape</span>

<span class="n">rural_2019_df</span> <span class="o">=</span> <span class="n">asset_pred_rural_df</span><span class="p">[</span><span class="n">asset_pred_rural_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="mi">2019</span><span class="p">]</span>
<span class="n">rural_2019_df</span><span class="o">.</span><span class="n">shape</span>

<span class="n">rural_2020_df</span> <span class="o">=</span> <span class="n">asset_pred_rural_df</span><span class="p">[</span><span class="n">asset_pred_rural_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="mi">2020</span><span class="p">]</span>
<span class="n">rural_2020_df</span><span class="o">.</span><span class="n">shape</span>

<span class="n">rural_2021_df</span> <span class="o">=</span> <span class="n">asset_pred_rural_df</span><span class="p">[</span><span class="n">asset_pred_rural_df</span><span class="o">.</span><span class="n">SURVEY_YEAR</span><span class="o">==</span><span class="mi">2021</span><span class="p">]</span>
<span class="n">rural_2021_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(304, 3)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>


<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span>

<span class="n">divnorm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">TwoSlopeNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">vcenter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">markersize</span><span class="o">=</span><span class="mi">5</span>
<span class="n">subplot_title_size</span> <span class="o">=</span> <span class="mi">16</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Asset Wealth Verteilung der besten Modelle für Mosambik&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.53</span><span class="p">)</span>

<span class="n">moz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">rural_2016_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mosambik 2016&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">subplot_title_size</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">moz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">rural_2017_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mosambik 2017&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">subplot_title_size</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">moz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">rural_2019_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mosambik 2019&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">subplot_title_size</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">moz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">rural_2020_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mosambik 2020&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">subplot_title_size</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">moz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">rural_2021_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mosambik 2021&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">subplot_title_size</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">cbaxes</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.066</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">.92</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Asset Wealth&#39;</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cbaxes</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/asset_wealth_prognosis_78_0.png" src="_images/asset_wealth_prognosis_78_0.png" />
</div>
</div>
</section>
</section>
<section id="Plot-Predictions">
<h2>Plot Predictions<a class="headerlink" href="#Plot-Predictions" title="Permalink to this headline">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>


<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span>

<span class="n">divnorm</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">TwoSlopeNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">vcenter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">markersize</span><span class="o">=</span><span class="mi">5</span>
<span class="n">subplot_title_size</span> <span class="o">=</span> <span class="mi">16</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Asset Wealth Verteilung der besten Modelle für Mosambik&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">.8</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.53</span><span class="p">)</span>

<span class="n">moz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">rural_2016_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>

<span class="n">urban_2016_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>


<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mosambik 2016&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">subplot_title_size</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">moz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">rural_2017_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
<span class="n">urban_2017_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>


<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mosambik 2017&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">subplot_title_size</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">moz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">rural_2019_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
<span class="n">urban_2019_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mosambik 2019&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">subplot_title_size</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">moz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">rural_2020_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
<span class="n">urban_2020_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mosambik 2020&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">subplot_title_size</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">moz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">rural_2021_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
<span class="n">urban_2021_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">,</span>
                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mosambik 2021&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">subplot_title_size</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">4</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">cbaxes</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.066</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">.92</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Asset Wealth&#39;</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cbaxes</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/asset_wealth_prognosis_80_0.png" src="_images/asset_wealth_prognosis_80_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;urban&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;2016&#39;</span><span class="p">:</span> <span class="n">urban_2016_df</span><span class="p">,</span>
                  <span class="s1">&#39;2017&#39;</span><span class="p">:</span> <span class="n">urban_2017_df</span><span class="p">,</span>
                  <span class="s1">&#39;2019&#39;</span><span class="p">:</span> <span class="n">urban_2019_df</span><span class="p">,</span>
                  <span class="s1">&#39;2020&#39;</span><span class="p">:</span> <span class="n">urban_2020_df</span><span class="p">,</span>
                  <span class="s1">&#39;2021&#39;</span><span class="p">:</span> <span class="n">urban_2021_df</span><span class="p">},</span>

        <span class="s1">&#39;rural&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;2016&#39;</span><span class="p">:</span> <span class="n">rural_2016_df</span><span class="p">,</span>
                  <span class="s1">&#39;2017&#39;</span><span class="p">:</span> <span class="n">rural_2017_df</span><span class="p">,</span>
                  <span class="s1">&#39;2019&#39;</span><span class="p">:</span> <span class="n">rural_2019_df</span><span class="p">,</span>
                  <span class="s1">&#39;2020&#39;</span><span class="p">:</span> <span class="n">rural_2020_df</span><span class="p">,</span>
                  <span class="s1">&#39;2021&#39;</span><span class="p">:</span> <span class="n">rural_2021_df</span><span class="p">}</span>
       <span class="p">}</span>
<span class="n">statistics</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ur</span><span class="p">,</span> <span class="n">ur_data</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">ur_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">statistics</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ur</span><span class="p">,</span>
                           <span class="n">year</span><span class="p">,</span>
                           <span class="nb">round</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">Prediction</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="mi">2</span><span class="p">),</span>
                           <span class="nb">round</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">Prediction</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="mi">2</span><span class="p">),</span>
                           <span class="nb">round</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">Prediction</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="mi">2</span><span class="p">),</span>
                           <span class="nb">round</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">Prediction</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span><span class="mi">2</span><span class="p">),</span>
                           <span class="nb">round</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">Prediction</span><span class="o">.</span><span class="n">var</span><span class="p">(),</span><span class="mi">2</span><span class="p">),</span>
                           <span class="nb">round</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">Prediction</span><span class="o">.</span><span class="n">skew</span><span class="p">(),</span><span class="mi">2</span><span class="p">),</span>
                           <span class="nb">round</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">Prediction</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(),</span><span class="mi">2</span><span class="p">)])</span>
<span class="n">pred_statistics_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">statistics</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Urban/Rural&#39;</span><span class="p">,</span><span class="s1">&#39;Jahr&#39;</span><span class="p">,</span><span class="s1">&#39;Min&#39;</span><span class="p">,</span><span class="s1">&#39;Max&#39;</span><span class="p">,</span> <span class="s1">&#39;Arithmetisches</span><span class="se">\n</span><span class="s1">Mittel&#39;</span><span class="p">,</span><span class="s1">&#39;Median&#39;</span><span class="p">,</span><span class="s1">&#39;Varianz&#39;</span><span class="p">,</span><span class="s1">&#39;Schiefe&#39;</span><span class="p">,</span><span class="s1">&#39;Kurtosis&#39;</span><span class="p">])</span>
<span class="n">pred_statistics_df</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;urban&#39;, &#39;2016&#39;, 0.32, 3.38, 1.53, 1.45, 0.32, 0.57, 0.7]
[&#39;urban&#39;, &#39;2017&#39;, 0.32, 3.3, 1.55, 1.51, 0.32, 0.47, 0.48]
[&#39;urban&#39;, &#39;2019&#39;, 0.33, 3.36, 1.57, 1.52, 0.3, 0.61, 0.88]
[&#39;urban&#39;, &#39;2020&#39;, 0.35, 3.4, 1.59, 1.53, 0.34, 0.58, 0.55]
[&#39;urban&#39;, &#39;2021&#39;, 0.33, 3.32, 1.57, 1.53, 0.34, 0.53, 0.47]
[&#39;rural&#39;, &#39;2016&#39;, -0.62, 1.02, -0.52, -0.59, 0.04, 4.61, 25.61]
[&#39;rural&#39;, &#39;2017&#39;, -0.63, 1.02, -0.51, -0.59, 0.05, 4.16, 20.34]
[&#39;rural&#39;, &#39;2019&#39;, -0.62, 1.05, -0.51, -0.59, 0.05, 4.47, 23.02]
[&#39;rural&#39;, &#39;2020&#39;, -0.67, 0.96, -0.51, -0.59, 0.05, 4.23, 20.31]
[&#39;rural&#39;, &#39;2021&#39;, -0.59, 0.81, -0.5, -0.59, 0.05, 3.66, 14.73]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Urban/Rural</th>
      <th>Jahr</th>
      <th>Min</th>
      <th>Max</th>
      <th>Arithmetisches\nMittel</th>
      <th>Median</th>
      <th>Varianz</th>
      <th>Schiefe</th>
      <th>Kurtosis</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>urban</td>
      <td>2016</td>
      <td>0.32</td>
      <td>3.38</td>
      <td>1.53</td>
      <td>1.45</td>
      <td>0.32</td>
      <td>0.57</td>
      <td>0.700000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>urban</td>
      <td>2017</td>
      <td>0.32</td>
      <td>3.30</td>
      <td>1.55</td>
      <td>1.51</td>
      <td>0.32</td>
      <td>0.47</td>
      <td>0.480000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>urban</td>
      <td>2019</td>
      <td>0.33</td>
      <td>3.36</td>
      <td>1.57</td>
      <td>1.52</td>
      <td>0.30</td>
      <td>0.61</td>
      <td>0.880000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>urban</td>
      <td>2020</td>
      <td>0.35</td>
      <td>3.40</td>
      <td>1.59</td>
      <td>1.53</td>
      <td>0.34</td>
      <td>0.58</td>
      <td>0.550000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>urban</td>
      <td>2021</td>
      <td>0.33</td>
      <td>3.32</td>
      <td>1.57</td>
      <td>1.53</td>
      <td>0.34</td>
      <td>0.53</td>
      <td>0.470000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>rural</td>
      <td>2016</td>
      <td>-0.62</td>
      <td>1.02</td>
      <td>-0.52</td>
      <td>-0.59</td>
      <td>0.04</td>
      <td>4.61</td>
      <td>25.610001</td>
    </tr>
    <tr>
      <th>6</th>
      <td>rural</td>
      <td>2017</td>
      <td>-0.63</td>
      <td>1.02</td>
      <td>-0.51</td>
      <td>-0.59</td>
      <td>0.05</td>
      <td>4.16</td>
      <td>20.340000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>rural</td>
      <td>2019</td>
      <td>-0.62</td>
      <td>1.05</td>
      <td>-0.51</td>
      <td>-0.59</td>
      <td>0.05</td>
      <td>4.47</td>
      <td>23.020000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>rural</td>
      <td>2020</td>
      <td>-0.67</td>
      <td>0.96</td>
      <td>-0.51</td>
      <td>-0.59</td>
      <td>0.05</td>
      <td>4.23</td>
      <td>20.309999</td>
    </tr>
    <tr>
      <th>9</th>
      <td>rural</td>
      <td>2021</td>
      <td>-0.59</td>
      <td>0.81</td>
      <td>-0.50</td>
      <td>-0.59</td>
      <td>0.05</td>
      <td>3.66</td>
      <td>14.730000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="asset_wealth_analysis.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Statistical Analysis of Asset Wealth</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="split_geotiffs_for_preprocessing.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Split and copy raw GeoTIFFs to separate directories for preprocessing</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Pia Störmer<br/>
  
      &copy; Copyright 2022, Pia Störmer.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>